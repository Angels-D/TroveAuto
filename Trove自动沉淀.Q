[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=58ef3714-8ca9-4883-b4f5-47b8d2d34378
Description=Trove自动沉淀-By妖尾
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Main
[Relative]
SetupOCXFile=
[Comment]
Trove自动沉淀 - For 深渊
1. 制作符文，使其破碎来获得符文碎片，点亮符文铁砧的击杀深渊秘境生物获得符文碎片
2. 在深渊秘境击杀足怪物，积攒足够多的符文碎片
3. U12深渊采集植物兑换符文精华或制作可以获得符文精华的宠物
4. 积累上述材料，点亮符文铁砧的全部下部区域和中部区域的符文破碎获取更多符文碎片
5. 进入主世界，不断重复进入同一世界，可以使用本脚本自动执行
6. 执行约几小时后，搭配符文使其破碎，可获得大量符文碎片
7. 点亮符文铁砧的开启5*宝箱获得符文封印宝箱
8. 重置锻造星图，卸下装备的符文，不要点亮其他多余的节点
9. 进入U12，不断重复进入同一世界，可以使用本脚本
10.组队或单刷U12 5*副本，开启大宝箱可获得大量符文封印宝箱
注意：若刷本过程中出现大延迟，则证明该世界中有人正在执行步骤9，或有人步骤8没有做到位
      获取世界ID的方法：/getworldid
― By妖尾

[UIPackage]
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


[Script]
Global i, FID, TID
Event Main.Load 
    Main.ProgressBar1.Value = 0
    Main.FishGrid.SetColumnEditable 0, False
    Main.FishGrid.SetColumnEditable 5, False
End Event
Event Main.FishMsgBtn.Click
    Main.ProgressBar1.Value = 0
    G = Plugin.Window.SearchEx("SDL_app", "Trove", 0)
    GameGB = Split(G, "|")
    Main.ProgressBar1.Value = 30
    If  UBound(GameGB) >= 0 Then 
        i = 0
        For UBound(GameGB)
            Call Plugin.Window.SetText(GameGB(i), "正在检测中")
            Call Plugin.Window.SetText(GameGB(i), CStr(i + 1) + "号")
            Main.FishGrid.RowCount = Main.FishGrid.RowCount + 1
            Main.FishGrid.SetColumnEditable 0, False
            Main.FishGrid.SetColumnEditable 5, False
            Main.FishGrid.SetItemText i + 1, 0, CStr(i + 1) + "号"
            Main.FishGrid.SetItemText i + 1, 1, CStr(GameGB(i))
            i = i + 1
            Main.ProgressBar1.Value = Main.ProgressBar1.Value + 70 /  UBound(GameGB)
        Next
        MessageBox "检测结束"
    Else 
        MessageBox "未找到游戏句柄!"
    End If
    i = 0
    Main.ProgressBar1.Value = 0
End Event
Event Main.Button2.Click
    Main.ProgressBar1.Value = 0
    For Main.FishGrid.RowCount - 1
        i = i + 1
        If Main.FishGrid.GetItemText(i, 1) <> "" Then 
            Call Plugin.Window.SetText(Main.FishGrid.GetItemText(i, 1), "Trove")
        End If
        Main.ProgressBar1.Value = Main.ProgressBar1.Value + 80 / (Main.FishGrid.RowCount - 1)
    Next
    i = 0
    Main.FishGrid.RowCount = 2
    Main.FishGrid.DeleteAllItems 
    Main.ProgressBar1.Value = 100
    MessageBox "重置完成"
    Main.ProgressBar1.Value = 0
End Event
Event Main.FishAddBtn.Click
    Main.FishGrid.RowCount = Main.FishGrid.RowCount + 1
    Main.FishGrid.SetColumnEditable 0, False
    Main.FishGrid.SetColumnEditable 5, False
    X = Main.FishGrid.RowCount
End Event
Event Main.FishSubBtn.Click
    If Main.FishGrid.RowCount > 2 Then 
        Main.FishGrid.RowCount = Main.FishGrid.RowCount - 1
        X = Main.FishGrid.RowCount
    End If
End Event
Event Main.FishRunBtn.Click
    If Main.FishRunBtn.Caption = "开启" Then 
        Main.FishMsgBtn.Enabled = false
        Main.Button2.Enabled = false
        Main.FishAddBtn.Enabled = false
        Main.FishSubBtn.Enabled = false
        Main.FishGrid.SetColumnEditable 1, False
        Main.FishGrid.SetColumnEditable 2, False
        Main.FishGrid.SetColumnEditable 3, False
        Main.FishGrid.SetColumnEditable 4, False
        ReDim FID(Main.FishGrid.RowCount - 1),TID(Main.FishGrid.RowCount - 1)
        For Main.FishGrid.RowCount - 1
            i = i + 1
            If Main.FishGrid.GetCheckBoxValue(i, 4) Then 
                FID(i) = BeginThread(Fish)
                TID(i) = BeginThread(Time)
                Delay 500 
            End If
        Next
        Main.FishRunBtn.Caption = "关闭"
        i = 0
    Else 
        Main.FishMsgBtn.Enabled = True
        Main.Button2.Enabled = True
        Main.FishAddBtn.Enabled = True
        Main.FishSubBtn.Enabled = True
        Main.FishGrid.SetColumnEditable 1, True
        Main.FishGrid.SetColumnEditable 2, True
        Main.FishGrid.SetColumnEditable 3, True
        Main.FishGrid.SetColumnEditable 4, True
        For Main.FishGrid.RowCount - 1
            i = i + 1
            StopThread FID(i)
            StopThread TID(i)
            Delay 100 
        Next
        i = 0
        Main.FishRunBtn.Caption = "开启"
    End If
End Event
Sub Fish()
    Z = i
    Game = Main.FishGrid.GetItemText(Z, 1)
    WorldID1 = Main.FishGrid.GetItemText(Z, 2)
    WorldID2 = Main.FishGrid.GetItemText(Z, 3)
    Do
		Call Plugin.Bkgnd.KeyPress(Game, 13)	
		Delay 100
		Call Plugin.Bkgnd.SendString(Game, "/joinworld " & WorldID1)
		Delay 100
		Call Plugin.Bkgnd.KeyPress(Game, 13)
		Delay 4500
		Flag(Game)
		Call Plugin.Bkgnd.KeyPress(Game, 13)	
		Delay 100
		Call Plugin.Bkgnd.SendString(Game, "/joinworld " & WorldID2)
		Delay 100
		Call Plugin.Bkgnd.KeyPress(Game, 13)
		Delay 4500
		Flag(Game)
    Loop
End Sub
Sub Time()
    Z = i
    Main.FishGrid.SetItemText Z, 5, CStr(H) + ":" + CStr(M) + ":" + CStr(S)
    H = 0
    M = 0
    S = 0
    Do
        Delay 1000
        If S = 60 AND M = 60 Then 
            H = H + 1
            S = 0
            M = 0
        ElseIf S = 60 Then
            M = M + 1
            S = 0
        Else 
            S = S + 1
        End If
        Main.FishGrid.SetItemText Z, 5, CStr(H) + ":" + CStr(M) + ":" + CStr(S)
    Loop
End Sub
Function Flag(Game)
    c1 = Plugin.Bkgnd.GetPixelColor(Game, 100, 100) 
    c2 = Plugin.Bkgnd.GetPixelColor(Game, 200, 200)
    Do
        Delay 100
        If Plugin.Bkgnd.GetPixelColor(Game, 100, 100) <> c1 and Plugin.Bkgnd.GetPixelColor(Game, 200, 200) <> c2 Then 
        	Delay 100
        	Exit Do
        End If
    Loop
End Function