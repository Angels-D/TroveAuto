[General]
SyntaxVersion=2
BeginHotkey=0
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=0
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=30bf0d94-3ed0-41be-8612-c5d88758d264
Description=Trove¸¨Öú-ByÑýÎ²
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]
ByÑýÎ²

[UIPackage]
UEsDBBQAAgAIABxu+E4BvPX7CRMAAAgCAQAJABEAVUlQYWNrYWdlVVQNAAeeYThdnmE4XZ5hOF3tXQt4VcW1XpuAhBAeQUAExPBGkUcIiaBoJbwhPEyCUttaAwTINSSYh0/6bm1v349be/su9mW1vS29Fd8itVTEKlQrF9vaarW1VtvSSq2lVfqvvc9ONmlSzppZycq5ZPj+b/Idzt7/ntkza+ZfM7NOFkVp/768p7ZtH/40tUrnUxa9drQPnZT4LEghTAOJeiDLAl47evRo/PHR7pRR6VWgJ95bMcDvuhfQG+gDZAM5QD+gL5AL9I9ePQ0A8oCTgUHAYGAoMAQ4BTgVGAYMB0YCI4DTgNOBUUA+MBYYDYwBxgETgPHAROAMYBJwJnAWMBmYAkwDpgLTgRlAAVAInA3MBIqAWUA1cA4wGzgXOA+YE7ZroguA1wFzgXlACTAfWAgsABYBS4DFwFJgObAMKAVWAKuAlcCFQDlQBlQAFwGrgYuBS4A1wOuBNwBvAt4IXApcBrwZqATWAWuB9cAGoArYCPwHsAm4PNW/apHXAJuBOuAKYAtQDzQCDUATcBVwJXA1cB1wDXAtsBV4K/AW4G2pezLKcLc63CEfJa9FXh9ekX4aihYTt6XgeF/ee/3aZ+Y+HrDNuG959NFq1PR0ck/ZFAQx/4J2vrO/IuKN+ZP/Nw9vrtTjCXIS/L2Ow//Udf/KX4H63oK3vgKtYXP49mVpEPUI+fNStjfd63qm8rgddFWckbIBXf05MxUL6+o3e3Q/4usLPK4PyC/5Xu+bKurrrqy6/aYDRxyvF3TZDrne1e602L8ex8z50n1nsa3kUacSI2CN4zP0h/3rS9E8JV3+Hgn7dxFmCg2A6xMMdCh/VoK/DKyVGP1Xoh5qhGNvbP9zU/dMl79ngr8C/FeHMwjn9x9Iy8/vvk/q73mYfdQA9Y5PMtiB/6RE+Vv4S/Ae1oXzLSF/OF8eIKj/3q3e/zrP+uf5ebaAP5uiOXwybUCnfIkyL/U25n+57ToPh6Xl5fnllbUN+eVV9dUbOoh//C2Xel1/CSxPPexPVagk5Int75BUn0q3/fVJtP9S9D15rzu2/Q9M3S9d/pw2+385nmMT6kE2Gg5D/481cLr8fRP8czH73xKOAfVALZ5BNgoNRfn7UKTL0+XPTfAvRNlr/eyPePxjezWnufw1GH034hm43mtd7L+Yv/8x778S9d+IZ+B6KAnfQzwStLSN9tMk1P9QavF7pcM/IMFfEt4/6n/p8LXR/oLBQv6BCX5f++E7//RNFZVr59XVNtbX1fhe76ZiMl6/oOU3hnNfl9YX2h9x/8tLtL9V4L8a7DWhB0ue+jvwD2rFz/OvJpTbxQszzIE/6S+P/E/uCpr9T6xn2C86vJ3vxH6njvI/TRTan5MpGoM5WehPtpd9U39r6M98ivza6fIPIVX9GYwW1v9Q0tWfIyjy9afLfwqp6k/P/tf5+nMY6epPXl8ZJ6j/UxP8vsl3/GdfANuv9bBKhxyu70G2KcuY31d/avgfeP1ugqD9DacW/4OC/hT3/xGkqz/Hp/pUuvwjSVV/Brw+OkXAfxrp6k9ez50k4B9FtvqTx+pYfy4BN9d5gyN/LsrP9XmmoPz5qXfAqTyc+0Z9sCpcBZalQQ7lH52o/yzK3b/tzt07X7znye/d8tDDPW99+bFnsne++NATe1544EAn2C/r9Q/rNNLzel/9XhHOfiUej2PTcLQ/3scxVdD+x1By/sf8Dc5PMNKh/Y9N8Jej313jPPsP+7+Yf1wb5edRsDrlAats9kelY0vk/OPb4F8MbvbDbRLaYhf9P+GY+m+xf47+LzH/RDp2/I3qvBo5W2DZiDAK9p/3KEwWtH8eK7/dzM/6f4Zz/03uP2nvLv9O/7MvtHd56ZL5C8oK+D9yV5WtXFS2oLy8ZG70Qa9FZUvmh3fuXTq3ZEFpQWHzp+H/9y5ZXVGxcsUsavmb92JRnyUrVq2uKFm5Jvmt4sS3ihKfz0z8XZj4e0bi74I2XWXlNdXrq+qdqy91vbv/JfP9fzr7jyT9j/tKvK9Uwf8j5uf5crxuqOH/4bZ/tqD/TyFd/89skvl/ppKu/4f3X04XlH8a6e8/uEDAb+3/mU66/h/e9zpHUP4C6jr+n5somo9dHET7bzMtdft/egS8z7pI0P5mkK3/p5BU/T/hXvICQflnkq7/Zx7J7H8R6fp/eFZXIih/Mdn6f3isjv0/y1Hqqz36X7YD/6xE+ZeHusOLP+AzDecJ6n92gv9mY/t1g+f11vNvX//LvAev97q+tHJtVY3H9Reh/ddQU6f6P86h5PyvOrS/C8P19yvCJ2ErlO5MdCTa/3yS2b9zE/yufpc4sf+B7zdX0P/mUHL+H9d/5+2/OK9N/hJa5Oj/k/KfT8nxj/0fhc7tl/0fvJ78XxSd12ordfT+By53heD983wh3v9usf/hAmrRv6H9KHCv/0z3f+x6vl/O/Yf75ezY0y/H5Xrr/XN8li8f+DKRUy/S8H/wmcjlgvY/l3T9HyspOnuZLn8J6fo/+KzoQgH/PLI9f8HjZW7zs3S+/2MB6fo/llJ0Bjdd/oWke/6CzwMvE/AvIlv9uzhRfmv76+s/8X1+X/9JNmV20tj/Up5q0+m2vyWk6/9g3tUC/qWk6//guAAXCviXka3/g5/X8vzFckqOf1G9N+AtVIYaUPYMLuu/K455/03gq0Prq6Zr3eb/Yv6V1Fr/zPR4/y3rv5e0853O0D8bBO1/VcJuWugf7qvx+VON+e9lFMXzSJe/jHTnvxxHZKOAvzzBv6R2S1NjSZ2zCzS+3nUFPdP1Y0HRdFN+X/2ooX84vs0aQfurIFv9w3OFeN6poH/E9uci0tU/HFdovaD+LyZd/cPxi94k4F9Dtvrn9aS7/7sqdc90+S8h3fPHHCuqWsD/hgT/OyhaD7yRonm5NHWfv/DTj9bjl4b+4Thl6wTt741kq3/YVlnqn0spef60EvO/BroqdQ5cmlz0x5spuf7chBrgda/S1A5YcfkDLk+N4P1fluBfEZZ7c7gK5Xr+XVr+ygT/YvBd6Xz6Pmr/l5Ns/XFtq/a/Du+goRPX/9aR3v4v3/WPM2/d5HX9iG0VpvazpKmxsa7W93q7/cc866gPW15NKvpFx9u/9dTa/1Hk/Pzs/+D5LM9jtrTznc7wf0jKzyyK+5/F9c9zEc39zxxvtInSt/8byTb+2ibSXf/jmKu1gvJXk63+Zb2QrWQ/fNOOXXu27d+970bX6339H77jF+9l5/OU3HJcvLjW+sVi/fdy0vV/8Jh1raD/1ZCu/4Odpw0C/s2k6v8IOLbzFQL+WtL1f3Cc6ToBfx3p+j84rvXbBfxbSHf9rzHV/9Plv4Js9S+3tDldxP5Yx0+ctsNPf8zcaatfVtXXbayvamgoqXSzHxbxtxpIVf+L+RtJV/9L+Zso6f/hNW/2APHZ487Zf3slqcY/C+LfFHCPf1bsYf9a1r/f3c53upr+Y73Qt7n9d77+4/lK7r/aDycnRKav3/qmQ4cOeV3POuzXwBpUxO8cru/l+fwa+v/9yP9T0P+vId39Dx8gmf/1WtLV/+9B/k5B+a8jW/1vff55K+nqPz5B9WFB/b+FdPXfB5G/V8D/VrJd/34b6eq/jyB/l6D8bydd/fcx5B8V8L+DdPXf+5B/SMD/TrLVf/yu5iRsQUfi09T92z1dGeSZTvT9F77+Y+vzYwrnX8Px/xMC+/du0o1//3GSzf/eQ7bnb68n2/O376XW669ne4w/QejPZu3yuXa+E+vuQzd2jP7+qvD9v4+S/qfO19+slTR//+rzyD8t6H/vT5R/UX31evJIfP2J/PtvvsnXfrP/gM/TsP/glw7Xa+jvL1B0/jjd9vcB0tXf/438kwL+D5Ku/v6K0P5Y6+8Pkar+Dj6F/EuC+v8w6ervLyL/jID/I2Srvz9KuvqbN0/cICj/xxL8OWSbuvdv+yXf/fca52+3If+6oP19nHT9L59F/jUB/yfI1v/CsWpi/8sC2J7qUHu5jcAu+78/Scn4y/zuO7f8N1DS/tfRVWErbHJ6Dy7l/xS1Hv+a0OrdfgkgXv/9lqD98XxlbXP7i9bf1zvWBMe/uoWiOJrp8n8mUf6TqN+du7//wtbC6VsL8G9m3mOP7Lvt3me3H9laHH/y4N8ePXzMJ322FhaFfxXk8c8F3PPKjj1bi6NPivPuePSuI3u33/1s/Mlxjkda28/BxvwHDx70ut53/3xL+2vpCbWCVjgG7e9mks1/P5tof/PBvQF8VeEOdHkUepf4/5+jpP2Pyx/Pv2U+mFEO/J9vk7+Elrn5f4JvIv+GoP9/gWzj73+RVP1/Yv4vUWv/1yzn/pPcf7K9ne/Efq+O8n9Jy8/ztfj8ga//Wef8i/vvH2S6/+jAwQP3+1zv6z+y8H+yXtU8f3Ib8h0C+/dlsj1/8hXS9X/dTtHviaTL/1Wy3X/yNWrL/9R5/q+vk+7+k/9Ffpeg/m8iXf/XHci/J+D/BrX4v3ztP8f94tUjLsFSh+v7km060fe/a5w/uQf5dwXt72bS9X/ejfw7Av5bSHf/0U7kuwT83yRd/9etyO8U8H+LbP1f/0Mt/i+L8wffJtvzB98h2/MH2xP8mX7+RUd/nLjxry3On3yXdM+f3Iv8PvI5fzLbw/4FoT3j30rd3c53upr+5/mqZfwBnqtq6r+HkO8VvP9byVb/7SBd/fcj5PcLyn8b2eq/2xN2z0L/3UG6+u8B5PsE9X8n6eq/h5HvEfDfRS36bzL5Jev4C/xbumy9WYMuc7g+l2yTdfxzDf33Y+Q/FLS/u0lX/+1H/gMB/z2kq/8eQ/64gP9e0tV/DyJ/RMC/k2z1331kq/92ka3++z7Z6r/7E/zd8Re6gv50j//ua/8t9N8PSFf/PYr8J+Sj/wrINYp3bmL994l2vtPV9B/rVEv9x3MFTf3H+95/IXj/D5Ct/ttDuvrvKeT/Jyj/g9R1fv9niuf11vqjH0X6I5/c9Ec/4/q30P97yVb/P0S6+v9nyJ8R9L8fka7+fxr5zwX8D5Nu/DmOX/JTAf8jpKv/nkV+UMC/j3T133PInxfw7ydd/fck8l8J+H+c4M/031/zTSe6/rDQ/zxft9T/j5Gt/v8J2er/x8k2/twB0tV/v0H+W/LTf65nmFn/sT9nGCzW79v5TlfTf6wVLPUfj9Wa+u8l5H8WvP8nyFb//ZR09d9h5C8Iyv+zBH80frjH38/0/Q87b/7hYZ/rrfUnn9/Np2gdzyWKpoX++znZ7v99knT13x+R/1XQ/35BuvrvL8gPCfh/Sbr672/I/yDgf4p09d8ryF8U8D9Nuvrv78hfFfD/inT135+QvyzgfybB359sU3f8cVv9aaH/2F9jqf9+Tbb67zdkq/+eI1v991vS1X9HkP+D/PSf6wnE5PrfSe1MZjta/w0IZOevn0/Uv6//SSN+2AyP67vjh2Xe+U+OFagZ/643XmJWkH7/f4F0449ng7ufgP9F0tX/PZhbYP9+T7r7f/sHmRX/7A+kG/8sQPlzBO//j6Sr//qAu6eA/xC16D/eC8J7Zzl+4HMO/AOM7V93/DC/ZBH/7k+kq/9zg6gi0+X/M6nq/6AvuPME/C+Rrv7vBe6BAv7DZLv/l/1VlvHPXibb+Gd/Jdv4Z68k+H3jB2YdN35YS7Swrmj/TvT4X1rx704R2B/2F5/VbH/8498NAfcgAf8Raiv+lnv8s8HC+e/fyTb+2T/INv7Zq6Qb/2wo6v9kwft/jWzjnx0l2/hnbHRj/v/Pv23SnY6fukb8N/fff8x0/5/1+dvY/+0aASMXNcj29CxU5Agj/7fU/rG/xnL/E/vrNPc/jcb98gXjX1Zgu/+pZ6Dr/xyD+50qKH+vwDb+Aa8TWZ5/6B3o7n85DfcbL6j/7EDX/zkW9xsl4Gd/qeb+l4m430gBf06g6/+agPsNF/D3TfD7jv8LcK+xFPmPXXYR5pFtOtHPP2jsfzoDTztZ0P5yA13/5+m43zgBf7/A1v/J62WW+18GBLb7XwYGtvtf8gLb/S+DAt39L5NwvzMDt/0v3fEX+Hr33z/MdP0Z6z/XCBTx/qcLUJBpGaL/TjbWf4OV9V8R7jdT0P+HGOu/ocr6rxj3myIo/ynG+m+Ysf47NVH+TI+/MDWlP+Y66o9BZJus9YeG/i/AQ8wW9L/hyvr/bNxvhoB/hLL+Pxf3my7gH6ms/88Jon6QLv9pge75l/Nwv9cJ+Ecp679C3G+WgP90Y/2Xb6z/Rgfd8d+abUGX0B/uvz/la/8t9P8YY/0/1lj/j1PW/3Nwv/MDv/MvrifAef0vLvu84+g/2ts19N94Y/03QVn/LcH9Fgve/0Rj/TdJWf8tDaL5f7r8ZxjrP/bVZTf3v87Xf5ODrhP/b8euPdv27953o+v11vqTY6mMoWhO5WJDrfefaug/XgNcLuh/Zynrv2W430IB/xRl/bcS95sv4J+qrP9W4H4lAv5pyvrvQtyvXMA/XVn/LcL9SgX8Bcb6b4ax/isM9OL/+aZu/VlBlslC/8001n9FxvqvWFn/rcL9yhz13z8BUEsBAhcLFAACAAgAHG74TgG89fsJEwAACAIBAAkACQAAAAAAAAAAAACAAAAAAFVJUGFja2FnZVVUBQAHnmE4XVBLBQYAAAAAAQABAEAAAABBEwAAAAA=


[Script]
Global i, V, FID, TID
Event Form1.Load 
    V = 150
    Form1.ProgressBar1.Value = 0
    Form1.Grid1.SetColumnEditable 0, False
    Form1.Grid1.SetColumnEditable 5, False
End Event
Event Form1.Slider1.Slide
    V = Form1.Slider1.Value 
    Form1.InputBox1.Text = V
End Event
Event Form1.InputBox1.Change
    V = Form1.InputBox1.Text
    Form1.Slider1.Value = V
End Event
Event Form1.Button1.Click
    Dim Voice(4)
    Form1.ProgressBar1.Value = 0
    Form1.ProgressBar1.Value = 5
    RunApp ("C:\Windows\System32\SndVol.exe")
    Delay 500
    Voice(0) = Plugin.Window.Find("#32770", "ÒôÁ¿ºÏ³ÉÆ÷ - ÑïÉùÆ÷ (Realtek High Definition Audio)")
    Call Plugin.Window.Size(Voice(0), 2968, 353)
    Call Plugin.Window.Move(Voice(0), -2920, 700)
    Voice(1) = Plugin.Window.FindEx(Voice(0), 0, "TileListView", "")
    Voice(2) = Plugin.Window.FindEx(Voice(1), 0, "TileSled Window", "")
    Form1.ProgressBar1.Value = 20
    G = Plugin.Window.SearchEx("SDL_app", "Trove", 0)
    GameGB = Split(G, "|")
    VoiceGB = Split(G, "|")
    Form1.ProgressBar1.Value = 30
    If  UBound(GameGB) >= 0 Then 
        i = 0
        For UBound(GameGB)
            Call Plugin.Window.SetText(GameGB(i), "ÕýÔÚ¼ì²âÖÐ")
            Delay 1000
            Rem A
            Voice(3) = Plugin.Window.FindEx(Voice(2), Voice(3), "#32770", "")
            Voice(4) = Plugin.Window.FindEx(Voice(3), 0, "Static", "ÕýÔÚ¼ì²âÖÐ")
            If Voice(3) = 0 Then 
                MessageBox "Î´ÕÒµ½ÉùÒô¾ä±ú!"
                i = 0
                Call Plugin.Window.SetText(GameGB(i), "Trove")
                Form1.ProgressBar1.Value = 0
                Exit For
            Elseif Voice(4) = 0 then
                Goto A
            Else 
                VoiceGB(i) = Plugin.Window.FindEx(Voice(3), 0, "msctls_trackbar32", "")
                Call Plugin.Window.SetText(GameGB(i), CStr(i + 1) + "ºÅ")
                Form1.Grid1.RowCount = Form1.Grid1.RowCount + 1
                Form1.Grid1.SetColumnEditable 0, False
                Form1.Grid1.SetColumnEditable 5, False
                Form1.Grid1.SetItemText i + 1, 0, CStr(i + 1) + "ºÅ"
                Form1.Grid1.SetItemText i + 1, 1, CStr(GameGB(i))
                Form1.Grid1.SetItemText i + 1, 2, CStr(VoiceGB(i))
            End If
            Voice(3) = 0
            i = i + 1
            Form1.ProgressBar1.Value = Form1.ProgressBar1.Value + 70 /  UBound(GameGB)
        Next
        MessageBox "¼ì²â½áÊø"
    Else 
        MessageBox "Î´ÕÒµ½ÓÎÏ·¾ä±ú!"
    End If
    i = 0
    Form1.ProgressBar1.Value = 0
End Event
Event Form1.Button2.Click
    Form1.ProgressBar1.Value = 0
    For Form1.Grid1.RowCount - 1
        i = i + 1
        If Form1.Grid1.GetItemText(i, 1) <> "" Then 
            Call Plugin.Window.SetText(Form1.Grid1.GetItemText(i, 1), "Trove")
        End If
        Form1.ProgressBar1.Value = Form1.ProgressBar1.Value + 80 / (Form1.Grid1.RowCount - 1)
    Next
    i = 0
    Form1.Grid1.RowCount =2
    Form1.Grid1.DeleteAllItems 
    V = 150
    Form1.Slider1.Value = V
    Form1.InputBox1.Text = V
    Form1.ProgressBar1.Value = 100
    MessageBox "ÖØÖÃÍê³É"
    Form1.ProgressBar1.Value = 0
End Event
Event Form1.Button3.Click
    Form1.Grid1.RowCount = Form1.Grid1.RowCount + 1
    Form1.Grid1.SetColumnEditable 0, False
    Form1.Grid1.SetColumnEditable 5, False
    X = Form1.Grid1.RowCount
End Event
Event Form1.Button6.Click
    Form1.Grid1.RowCount = Form1.Grid2.RowCount + 1
    X = Form1.Grid1.RowCount
End Event
Event Form1.Button4.Click
    If Form1.Grid1.RowCount > 2 Then 
        Form1.Grid1.RowCount = Form1.Grid1.RowCount - 1
        X = Form1.Grid1.RowCount
    End If
End Event
Event Form1.Button7.Click
    If Form1.Grid1.RowCount > 2 Then 
        Form1.Grid1.RowCount = Form1.Grid2.RowCount - 1
        X = Form1.Grid1.RowCount
    End If
End Event
Event Form1.Button5.Click
    If Form1.Button5.Caption = "¿ªÆô" Then 
        Form1.Button1.Enabled = false
        Form1.Button2.Enabled = false
        Form1.Button3.Enabled = false
        Form1.Button4.Enabled = false
        Form1.Slider1.Enabled = false
        Form1.InputBox1.Enabled = false
        Form1.Grid1.SetColumnEditable 1, False
        Form1.Grid1.SetColumnEditable 2, False
        Form1.Grid1.SetColumnEditable 3, False
        ReDim FID(Form1.Grid1.RowCount - 1),TID(Form1.Grid1.RowCount - 1)
        For Form1.Grid1.RowCount - 1
            i = i + 1
            If Form1.Grid1.GetCheckBoxValue(i, 3) Then 
                FID(i) = BeginThread(Fish)
                TID(i) = BeginThread(Time)
                Delay 500 
            End If
        Next
        Form1.Button5.Caption = "¹Ø±Õ"
        i = 0
    Else 
        Form1.Button1.Enabled = True
        Form1.Button2.Enabled = True
        Form1.Button3.Enabled = True
        Form1.Button4.Enabled = True
        Form1.Slider1.Enabled = True
        Form1.InputBox1.Enabled = True
        Form1.Grid1.SetColumnEditable 1, True
        Form1.Grid1.SetColumnEditable 2, True
        Form1.Grid1.SetColumnEditable 3, True
        For Form1.Grid1.RowCount - 1
            i = i + 1
            StopThread FID(i)
            StopThread TID(i)
            Delay 100 
        Next
        i = 0
        Form1.Button5.Caption = "¿ªÆô"
    End If
End Event
Sub Fish()
    Z = i
    Game = Form1.Grid1.GetItemText(Z, 1)
    Voice = Form1.Grid1.GetItemText(Z, 2)
    Form1.Grid1.SetProgressBarValue Z, 4, 0
    Call Plugin.Bkgnd.KeyPress(Game, 70)
    Delay 3000
    Do
        XY = Plugin.Bkgnd.FindColorEx(Voice, 5, 0, 10, Form1.InputBox1.Text, "5AC359", 1, 0.9)
        ZB = InStr(XY, "|")
        Form1.Grid1.SetProgressBarValue Z, 4, 25
        If ZB = 2 Then 
            Form1.Grid1.SetProgressBarValue Z, 4, 50
            Call Plugin.Bkgnd.KeyPress(Game, 70)
            Form1.Grid1.SetProgressBarValue Z, 4, 70
            Delay 2000
            Form1.Grid1.SetProgressBarValue Z, 4, 80
            Call Plugin.Bkgnd.KeyPress(Game, 70)
            Form1.Grid1.SetProgressBarValue Z, 4, 100
            Delay 3000
        End If
        Form1.Grid1.SetProgressBarValue Z, 4, 0
        Delay 100
    Loop
End Sub
Sub Time()
    Z = i
    Form1.Grid1.SetItemText Z, 5, CStr(H) + ":" + CStr(M) + ":" + CStr(S)
    H = 0
    M = 0
    S = 0
    Do
        Delay 1000
        If S = 60 AND M = 60 Then 
            H = H + 1
            S = 0
            M = 0
        ElseIf S = 60 Then
            M = M + 1
            S = 0
        Else 
            S = S + 1
        End If
        Form1.Grid1.SetItemText Z, 5, CStr(H) + ":" + CStr(M) + ":" + CStr(S)
    Loop
End Sub   